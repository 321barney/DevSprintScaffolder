# SoukMatch Environment Configuration
# Phase 1: Payment, Commission, AI, Security

# ========================================
# DATABASE
# ========================================
DATABASE_URL=postgresql://user:password@localhost:5432/soukmatch

# ========================================
# APPLICATION
# ========================================
NODE_ENV=development
PORT=5000
APP_URL=http://localhost:5000

# ========================================
# SECURITY (JWT & Auth)
# ========================================
# CRITICAL: Change these in production!
JWT_SECRET=change-me-to-random-64-char-string-in-production
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d
BCRYPT_ROUNDS=10

# Session secret (if using session-based auth as backup)
SESSION_SECRET=change-me-to-random-string

# ========================================
# AI SERVICES (Dynamic Pricing & Scoring)
# ========================================
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-api03-...

# AI Features toggle (set to 'false' to use static fallback pricing)
ENABLE_AI_PRICING=true
ENABLE_AI_SCORING=true

# ========================================
# PAYMENT SERVICE PROVIDER (PSP)
# ========================================
# Options: 'CMI', 'PayZone', 'MTC', 'test'
PSP_PROVIDER=test

# PSP Credentials (get from your Moroccan bank/PSP)
# For CMI (Centre Mon√©tique Interbancaire):
PSP_MERCHANT_ID=your_merchant_id_here
PSP_TERMINAL_ID=your_terminal_id_here
PSP_SECRET_KEY=your_secret_key_here

# PSP API Endpoints
# CMI Production: https://payment.cmi.co.ma/gateway
# CMI Sandbox: https://testpayment.cmi.co.ma/gateway
PSP_API_URL=https://testpayment.cmi.co.ma/gateway

# Callback URL (PSP will POST here after payment)
PSP_CALLBACK_URL=http://localhost:5000/api/payment/callback

# ========================================
# COMMISSION CONFIGURATION
# ========================================
# Platform commission rates (decimal format: 0.15 = 15%)
DEFAULT_COMMISSION_RATE=0.15
COMMISSION_RATE_TRANSPORT=0.12
COMMISSION_RATE_TOUR=0.18
COMMISSION_RATE_SERVICE=0.15
COMMISSION_RATE_FINANCING=0.20

# Free tier settings
FREE_OFFERS_PER_PROVIDER=4

# Subscription pricing (in MAD)
SUBSCRIPTION_BASIC_PRICE_MAD=299
SUBSCRIPTION_PRO_PRICE_MAD=799

# ========================================
# RATE LIMITING
# ========================================
# General API rate limit
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=60

# Auth endpoints (stricter)
AUTH_RATE_LIMIT_WINDOW_MS=60000
AUTH_RATE_LIMIT_MAX_REQUESTS=10

# Offer submission (per provider)
OFFER_RATE_LIMIT_WINDOW_MS=60000
OFFER_RATE_LIMIT_MAX_REQUESTS=20

# ========================================
# EMAIL (Optional - for notifications)
# ========================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
EMAIL_FROM=SoukMatch <noreply@soukmatch.ma>

# ========================================
# MONITORING & LOGGING
# ========================================
LOG_LEVEL=info
ENABLE_REQUEST_LOGGING=true

# Sentry (optional error tracking)
SENTRY_DSN=

# ========================================
# FEATURES FLAGS
# ========================================
# Enable/disable features during rollout
ENABLE_WEBSOCKET_OFFERS=false
ENABLE_KYC_FILE_UPLOAD=false
ENABLE_FINANCING_BROKER=false
ENABLE_ADMIN_PANEL=false

# ========================================
# DEVELOPMENT ONLY
# ========================================
# Seed database on startup (development only!)
AUTO_SEED_DB=false

# Enable detailed SQL logging
DEBUG_SQL=false

# Bypass authentication (NEVER use in production)
BYPASS_AUTH=false
